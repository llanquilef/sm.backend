from sqlmodel import SQLModel, Field, Relationship
from models.company import CompanyBase
from models.supplier import SupplierBase
from utils.timestamps.DateTimeToUTC import get_time_to_utc
from datetime import datetime
import uuid


UNIS_ENUMS = ['kg','un','gr','litro','ml','paq','caja','bot']


class ProductBase(SQLModel):
    """" Clase ProductsBase: Define los parametros esenciales para el modelo Product.  
         Class ProductsBase: Defines parameters over the ProductsBase model.
    """
    id: uuid.UUID = Field(default_factory=uuid.uuid4, primary_key=True)
    name: str = Field(max_length=100)
    description: str = Field(max_length=100)
    sku: str = Field(max_length=50)
    stockQuantity: int = Field(default=0)
    unit : enumerate = Field(default=UNIS_ENUMS[0], nullable=False)
    buyPrice: float = Field(default=0.0)
    salePrice: float = Field(default=0.0, nullable=True)
    minStockLevel: int = Field(default=0.0)
    profitMargin: float = Field(default=0.0)
    
class ProductsFK(ProductBase):
    """ 
    Clase ProductsFK: Esta clase define las FK's de el modelo base (ProductBase)
    Class ProductsFK: This class defines FK's over the class ProductBase
    """
    super.__init__()
    companyId: uuid.UUID = Relationship(CompanyBase.id, cascade_delete=True, link_model=CompanyBase)
    supplierId: uuid.UUID = Relationship(SupplierBase.id, cascade_delete=True, link_model=SupplierBase)
        
class ProductCreate(ProductBase):
    super.__init__()
    createdAt: datetime = Field(default_factory=get_time_to_utc, nullable=False)
    isActive: bool = Field(default=True, nullable=False)

class ProductUpdate(ProductBase):
    super.__init__()
    updatedAt: datetime = Field(default_factory=get_time_to_utc)

class ProductRead(ProductBase):
    super.__init__()



